/*!CK:2092055016!*//*1402982581,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["\/up\/P"]); }

__d("TooltipLink",["Parent","Tooltip"],function(a,b,c,d,e,f,g,h){var i={setTooltipText:function(j,k){j=g.byTag(j,'a');j&&h.set(j,k);}};e.exports=i;},null);
__d("DynamicFacepile",["DOM","TooltipLink","URI","XHPTemplate","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k){function l(){}k(l.prototype,{init:function(m,n,o,p){this._facepile=o;this._maxFacepileSize=n;this._memberIDs=m;this._facepileItemMap={};var q=g.scry(this._facepile,'li');for(var r=0,s=m.length;r<s;++r)this._facepileItemMap[m[r]]=q[r];this._template=p;},containsID:function(m){return this._facepileItemMap[m];},removeFacepileItem:function(m){var n=this._facepileItemMap[m.uid];if(!n)return;delete this._facepileItemMap[m.uid];this._memberIDs.splice(this._memberIDs.indexOf(m.uid),1);g.remove(n);},addFacepileItem:function(m){var n=this._template.render(),o=j.getNode(n,'img');o.src=m.photo;var p=j.getNode(n,'anchor');p.href=i('/profile.php').addQueryData({id:m.uid});h.setTooltipText(p,m.name);g.prependContent(this._facepile,n);this._facepileItemMap[m.uid]=n;this._memberIDs.unshift(m.uid);if(this._memberIDs.length>this._maxFacepileSize){var q=this._memberIDs.pop(),r=this._facepileItemMap[q];g.remove(r);delete this._facepileItemMap[q];}}});e.exports=l;},null);
__d("FriendsDashSideCol",["Arbiter","AsyncRequest","CSS","DOM","PageTransitions","$"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={init:function(n){this._flid=n;var o='listeditor/friend_lists_changed',p=g.subscribe(o,function(q,r){if(q==o&&r.list_info.list_id==this._flid){if(r.refresh_member_box)new h('/ajax/friends/lists/list_modified.php').setMethod('GET').setReadOnly(true).setData({list_id:this._flid}).send();if(r.removed_uid){j.scry(l('home_stream'),'.aid_'+r.removed_uid).forEach(i.hide);}else if(r.undo_remove&&r.added_uid)j.scry(l('home_stream'),'.aid_'+r.added_uid).forEach(i.show);}}.bind(this),g.SUBSCRIBE_NEW);k.registerHandler(g.unsubscribe.bind(null,p));}};e.exports=m;},null);
__d("legacy:friends-dash-sidecol-js",["FriendsDashSideCol"],function(a,b,c,d){a.FriendsDashSideCol=b('FriendsDashSideCol');},3);
__d("FriendListFilterNUXDialog",["Arbiter"],function(a,b,c,d,e,f,g){var h={init:function(i){g.subscribe(['FriendListMemberTypeahead/add','FriendListSuggestions/add'],function(){i.hide();});}};e.exports=h;},null);
__d("FriendListMembersBox",["Arbiter","CSS","DOM","DynamicFacepile","PageTransitions","copyProperties","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){}l(n.prototype,{init:function(o,p,q,r,s,t,u){this._root=o;this._flid=p;this._listSize=r;this._headerTitle=i.find(this._root,'.uiHeaderTitle');this._headerActions=i.find(this._root,'.uiHeaderActions a');this._facepile=new j();this._facepile.init(q,s,t.firstChild,u);var v=[g.subscribe(['FriendListSuggestions/add','FriendListMemberTypeahead/add','FriendListHovercard/add'],this.handleAddEvent.bind(this)),g.subscribe('FriendListHovercard/remove',this.handleRemoveEvent.bind(this))];k.registerHandler(function(){v.forEach(g.unsubscribe);});},handleAddEvent:function(o,p){if(p.flid!==this._flid||!p.uid)return;if(this._facepile.containsID(p.uid))return;if(!p.photo||!p.name){d(['ShortProfiles'],function(q){q.get(p.uid,function(r,s){if(s.exist){r.flid=this._flid;r.photo=s.thumbSrc;r.name=s.firstName;this._facepile.addFacepileItem(r);}}.bind(this,p));}.bind(this));}else this._facepile.addFacepileItem(p);h.removeClass(this._root,'empty');h.show(this._headerActions);this._listSize++;this.updateListSize();},handleRemoveEvent:function(o,p){if(p.flid!==this._flid||!p.uid)return;this._listSize--;this.updateListSize();this._facepile.removeFacepileItem(p);},updateListSize:function(){i.setContent(this._headerTitle,m._("On This List ({num_members})",{num_members:this._listSize}));}});e.exports=n;},null);
__d("legacy:FriendListMembersBox",["FriendListMembersBox"],function(a,b,c,d){a.FriendListMembersBox=b('FriendListMembersBox');},3);
__d("FriendListSuggestions",["Event","Arbiter","AsyncRequest","AsyncSignal","CSS","DOM","DynamicFriendListEducation","PageTransitions","Parent","copyProperties","csx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){}p(s.prototype,{init:function(t,u,v,w,x){this._container=t;this._flid=u;this._shouldSave=v;this._context=w;this._source=x;var y=g.listen(t,'click',function(aa){var ba=aa.getTarget();o.byClass(ba,'addLink')&&this._handleAdd(ba);o.byClass(ba,'declineButton')&&this._handleDecline(ba);}.bind(this)),z=h.subscribe('FriendListMemberTypeahead/add',function(aa,ba){var ca=r('suggestion_'+ba.uid);ca&&this._swap(ca);}.bind(this));n.registerHandler(function(){y.remove();z.unsubscribe();this._explicitHover&&this._explicitHover.uninstall();}.bind(this));},_handleDecline:function(t){var u=o.byTag(t,'li');this._swap(u);},_handleAdd:function(t){var u=o.byTag(t,'li'),v=this._getUIDFromItem(u),w=function(x){if(x&&x.nux_cancel)return;this._swap(u);if(this._shouldSave)this._save(v,x);var y=l.scry(u,"img._s0")[0],z=l.find(u,'.userSuggestionName');h.inform('FriendListSuggestions/add',{flid:this._flid,uid:v,name:l.getText(z),photo:y.src});}.bind(this);m.showContextualDialog(this._flid,v,t,w);},_getUIDFromItem:function(t){return ''+t.id.split('_')[1];},_swap:function(t){l.remove(t);var u=l.scry(this._container,'li.hidden_elem')[0];if(!u)return;k.show(u);var v=this._getUIDFromItem(u),w=''+u.getAttribute('data-coeff-key'),x={tids:[v],key:w};new j('/friends/ajax/log_data.php',x).send();},_save:function(t,u){var v={flid:this._flid,id:t,add:1,source:this._source};v[this.context]=1;if(u)p(v,u);new i().setURI('/friends/ajax/lists.php').setData(v).send();}});e.exports=s;},null);
__d("legacy:FriendListSuggestions",["FriendListSuggestions"],function(a,b,c,d){a.FriendListSuggestions=b('FriendListSuggestions');},3);
__d("FriendListMemberBoxTypeahead",["Arbiter","AsyncRequest","CSS","DynamicFriendListEducation","Event","PageTransitions","Style","copyProperties","removeFromArray"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){}n(p.prototype,{init:function(q,r,s){k.listen(q.getCore().getElement(),'keyup',function(event){i.conditionClass(event.getTarget(),'noPadding',m.get(event.getTarget(),'direction')=='rtl');});q.subscribe('select',function(u,v){var w=function(y){g.inform('FriendListMemberTypeahead/add',{flid:r,uid:v.selected.uid,name:v.selected.text,path:v.selected.path,photo:v.selected.photo});var z={add:1,search:1,source:s,flid:r,id:v.selected.uid};n(z,y);new h().setURI('/friends/ajax/lists.php').setData(z).send();};if(v.selected.subscribee||v.selected.type=='page')return w();j.showDialog(r,v.selected.uid,w);var x=q.getData().getExclusions();x.push(v.selected.uid);q.getData().setExclusions(x);});var t=g.subscribe('listeditor/friend_lists_changed',function(u,v){if(v.list_info.list_id==r){var w=q.getData().getExclusions();if(v.removed_uid){o(w,v.removed_uid);}else if(v.added_uid)w.push(v.added_uid);q.getData().setExclusions(w);}},g.SUBSCRIBE_NEW);l.registerHandler(g.unsubscribe.bind(null,t));}});e.exports=p;},null);
__d("legacy:FriendListMemberBoxTypeahead",["FriendListMemberBoxTypeahead"],function(a,b,c,d){a.FriendListMemberBoxTypeahead=b('FriendListMemberBoxTypeahead');},3);
__d("SourceSuggestionMegaphone",["Animation","Arbiter","AsyncRequest","CSS","DOM","Event","Parent","SubscriptionsHandler","copyProperties","$","createObjectFrom","csx","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=400,u=235,v=411,w=7;function x(y){h.subscribeOnce('Megaphone/show',function(z,aa){this.initData(y,aa);}.bind(this));}o(x.prototype,{initData:function(y,z){this._megaphoneWrapper=k.find(p(z),'.megaphone_story_wrapper');this._megaphone=k.find(this._megaphoneWrapper,'.sourceSuggestionMegaphoneContent');this._picker=k.find(this._megaphone,'#source_suggestion_picker');this._collector=k.scry(this._megaphone,'#source_suggestion_collector');if(this._collector[0])this._collector=this._collector[0];this._sourceCount=y.length;this._selected_sources=q(y);this._source_added=0;this._expandedMode=false;this._button=k.find(this._megaphone,'.doneButton');this._handler=new n();this._handler.addSubscriptions(l.listen(this._button,'click',function(event){this._hideMegaphone();}.bind(this)),l.listen(this._picker,'click',function(event){var ba=event.getTarget(),ca=m.byTag(ba,'li').id;this._pickerClick(ca);}.bind(this)));var aa=k.scry(this._megaphoneWrapper,'.megaphone_hide_link')[0];if(aa)this._handler.addSubscriptions(l.listen(aa,'click',function(event){this._hideMegaphone();}.bind(this)));},_expandPicker:function(){if(!this._expandedMode){this._expandedMode=true;new g(this._picker).to('height',u).duration(t).go();}},_fadeIn:function(y,z,aa){new g(y).show().from('opacity',0).to('opacity',1).duration(z).ondone(aa).go();},_fadeOut:function(y,z,aa){new g(y).from('opacity',1).to('opacity',0).hide().duration(z).ondone(aa).go();},_hideMegaphone:function(){this._fadeOut(this._megaphoneWrapper,t);this._handler.release();},_toggleSource:function(y,z,aa){this._expandPicker();var ba=k.find(this._picker,'ul'),ca=k.find(this._collector,'ul'),da=k.scry(this._megaphone,'#'+y);if(this._selected_sources[y]){this._sourceCount--;this._source_added--;this._selectElem(da[0],ba,false);this._selected_sources[y]=false;}else{this._sourceCount++;this._source_added++;if(z)z();this._selected_sources[y]=true;if(da.length){this._selectElem(da[0],ca,true);if(aa)aa();}else{new i().setURI('/ajax/friends/lists/cf_megaphone/picker_item').setData({id:y}).setHandler(function(ea){var fa=k.prependContent(ca,ea.payload)[0];this._fadeIn(fa,t);this._postSelect(true);this._selected_sources[y]=true;}.bind(this)).send();return;}}},_selectElem:function(y,z,aa){var ba=k.find(y,'.collector_item'),ca=k.find(y,'.picker_item'),da=aa?ba:ca,ea=aa?ca:ba;this._fadeOut(y,t,function(){k.prependContent(z,y);j.show(da);j.hide(ea);this._fadeIn(y,t);}.bind(this));this._postSelect(aa);},_postSelect:function(y){if(y){if(this._sourceCount===w+1){j.show(p('source_suggestion_collector_overflow_num'));}else if(this._sourceCount>w+1)this._updateCount();if(this._sourceCount){j.addClass(this._collector,"sourceSuggestionCollectorNonempty");j.show(p('source_suggestion_collector_placeholder'));}}else{if(this._sourceCount===w){j.hide(p('source_suggestion_collector_overflow_num'));}else if(this._sourceCount>w)this._updateCount();if(!this._sourceCount){j.removeClass(this._collector,"sourceSuggestionCollectorNonempty");j.hide(p('source_suggestion_collector_placeholder'));}}},_updateCount:function(){var y="_wj fbTimelineBoxCount fbTimelineBoxCountFriends",z=k.scry(this._megaphone,'.fbTimelineBoxCountFriends');if(z[0])k.replace(k.find(this._megaphone,'.fbTimelineBoxCountFriends'),k.create('span',{className:y},'+'+(this._sourceCount-w+1)));}});a.SourceSuggestionMegaphone=e.exports=x;},null);
__d("CloseFriendsSuggestionMegaphone",["Arbiter","AsyncRequest","CSS","DOM","Event","PageTransitions","Parent","SourceSuggestionMegaphone","$","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=25,r=5,s=8,t=17;for(var u in n)if(n.hasOwnProperty(u))w[u]=n[u];var v=n===null?null:n.prototype;w.prototype=Object.create(v);w.prototype.constructor=w;w.__superConstructor__=n;function w(x,y,z){"use strict";n.call(this,x);this._flid=y;this._coeff_key=z;}w.prototype.initData=function(x,y){"use strict";v.initData.call(this,x,y);var z=g.subscribe('listeditor/friend_lists_changed',function(aa,ba){if(ba.list_info.list_id==this._flid)if(ba.removed_uid&&this._selected_sources[ba.removed_uid]){this._pickerClick(ba.removed_uid);}else if(ba.added_uid&&!this._selected_sources[ba.added_uid])this._pickerClick(ba.added_uid);}.bind(this),g.SUBSCRIBE_NEW);this._handler.addSubscriptions(z,k.listen(this._collector,'click',function(event){var aa=event.getTarget(),ba=m.byTag(aa,'li').id;this._pickerClick(ba);}.bind(this)));l.registerHandler(g.unsubscribe.bind(null,z));this._warningShowed=false;this._displayed_picker_items={};this._logPickerImpression();};w.prototype._logPickerImpression=function(){"use strict";var x=j.scry(this._picker,'li'),y=this._expandedMode?t:s,z=Math.min(y,x.length),aa=[];for(var ba=0;ba<z;ba++){var ca=x[ba].id;if(!this._displayed_picker_items[ca]){this._displayed_picker_items[ca]=true;aa.push(ca);}}var da={tids:aa,key:this._coeff_key};new h().setURI('/friends/ajax/log_data.php').setData(da).send();};w.prototype._hideMegaphone=function(){"use strict";v._hideMegaphone.call(this);if(this._litestandRoot)return;var x='#navItem_fl_'+this._flid,y=j.find(p('sideNav'),x);if(y){i.removeClass(o('listsNav'),'belowThreshold');var z={flid:this._flid,purpose:'edu'};new h().setURI('/ajax/friends/lists/cf_megaphone/contextual_dialog').setData(z).send();}};w.prototype._pickerClick=function(x){"use strict";this._toggleSource(x,this._showWarning.bind(this),this._logPickerImpression.bind(this));var y={flid:this._flid,id:x,source:'closefriendsmegaphone'};if(this._selected_sources[x]){y.add=1;}else y.remove=1;new h().setURI('/friends/ajax/lists.php').setData(y).send();};w.prototype._showWarning=function(){"use strict";if(this._sourceCount>=q&&this._source_added>=r&&!this._warningShowed){this._warningShowed=true;this._showUserEducationWarning();}};w.prototype._showUserEducationWarning=function(){"use strict";var x={flid:this._flid,purpose:'warning',cf_count:this._sourceCount};new h().setURI('/ajax/friends/lists/cf_megaphone/contextual_dialog').setData(x).send();};w.init=function(x,y,z){"use strict";new w(x,y,z);};a.CloseFriendsSuggestionMegaphone=e.exports=w;},null);
__d("CloseFriendsTypeaheadRenderer",["DOM","SearchTypeaheadRenderer"],function(a,b,c,d,e,f,g,h){function i(j,k){var l=h(j,k),m=g.create('div',{className:'star'});g.appendContent(l,m);return l;}i.className='closefriends';e.exports=i;},null);
__d("legacy:CloseFriendsTypeaheadRenderer",["CloseFriendsTypeaheadRenderer"],function(a,b,c,d){if(!a.TypeaheadRenderers)a.TypeaheadRenderers={};a.TypeaheadRenderers.closefriends=b('CloseFriendsTypeaheadRenderer');},3);